---
title: "RR_P1"
author: "Auriane"
date: "9 april 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.path='Figs/')
```
## Project 1: Health Condition

### Libraries


```{r Load Libraries, message=FALSE, warning=FALSE}

library(dplyr)
library(lattice)
```
### 1. Loading and preprocessing the data

```{r Loading and preprocessing the data}
mydata <- tempfile()
download.file("http://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip", mydata)
unzip(mydata)
unlink(mydata)

df.activity <- read.table("activity.csv", sep=",", header = TRUE, na.strings = "NA")
df.activity$date <- as.Date(df.activity$date, "%Y-%m-%d")
head(df.activity)
```
### 2. What is mean total number of steps taken per day?

``` {r Total Steps per day, include=TRUE}
df.total <- df.activity %>%
  group_by(date=date) %>%
  summarise(TotalSteps = sum(steps))

df.total$date <- as.Date(df.total$date)
hist(df.total$TotalSteps, main="Total steps per day", col="pink", xlab="Number of steps")
```

```{r Mean Total Number of steps per day, include=TRUE }
mean_steps <- mean(df.total$TotalSteps, na.rm=T)

median_steps <- median(df.total$TotalSteps, na.rm=T)
```
The `mean` is 10 766.19 and the `median` is 10 765. 

### 3. What is the average daily activity pattern?

```{r Average daily activity pattern, include=TRUE}
IntervalSteps <- aggregate(steps ~ interval, df.activity, mean)
plot(IntervalSteps$interval, IntervalSteps$steps, 
     main="Average Daily Activity Pattern", type="l", 
     xlab="Interval", 
     ylab="Number of Steps")
```
```{r Maximum Number of steps}
maxSteps <- IntervalSteps[which.max(IntervalSteps$steps),1]
```

The maximum number of steps for 5-min interval is 835. 

### 4. Imputing missing values

In order to impute missing values, I decided to make use of the mean 5-min interval and make a left-join with the original dataset. 

```{r Imputing missing values, include=TRUE}
NA_Rows <- sum(is.na(df.activity))
IntervalSteps$steps_mean <- IntervalSteps$steps
IntervalSteps$steps <- NULL
df.activity <- left_join(df.activity, IntervalSteps, by="interval")
df.activity$Steps_complete <- df.activity$steps
steps_mean_vector <- as.numeric(df.activity$steps_mean[is.na(df.activity$steps)])
df.activity$steps[is.na(df.activity$Steps_complete)] <- steps_mean_vector
df.activity$Steps_complete <- NULL
df.activity$steps_mean <- NULL
Steps_day_sum <- aggregate(steps ~ date, df.activity, sum)
hist(Steps_day_sum$steps, main="Total steps per day", col="green", xlab="Number of steps")
Steps_day_mean <- mean(Steps_day_sum$steps)
Steps_day_median <- median(Steps_day_sum$steps)
```
### 5. Are there differences in activity patterns between weekdays and weekends?

We can see on the plots above that the mean is lower during weekends. 

```{r Activity pattern weekdays and weekends, include=TRUE}
df.activity$WE_WD <- weekdays(as.Date(df.activity$date))
weekends <- c("zaterdag", "zondag")
df.activity$weektype[df.activity$WE_WD %in% weekends] <- "weekend"
df.activity$weektype[!(df.activity$WE_WD %in% weekends)] <- "weekday"
df.activity$WE_WD <- NULL
steps_Weektype <- aggregate(steps ~ interval + weektype, df.activity, mean)
xyplot(steps_Weektype$steps ~ steps_Weektype$interval|steps_Weektype$weektype, 
       main="Activity pattern during weekends and weekdays",
       xlab="5-min Interval", ylab="Steps",
       layout=c(1,2), type="l")
```
